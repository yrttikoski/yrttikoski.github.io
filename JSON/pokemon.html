<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON</title>
    <link rel="stylesheet" href="style.css">

    <!-- Bootstrap css-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap javascript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>

    <!--Navigaatio-->
    <nav class="navbar navbar-expand-sm navbar-custom fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">

                <!--Logo/kuva-->
                <img src="flower.png" alt="Logo" style="width: 55px;" class="rounded-pill" href="index.html">
            </a>

            <button class="navbar-toggler custom-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapsibleNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="collapsibleNavbar">

                <!--Valikon linkit-->
                <ul class="navbar-nav">
                     <li class="nav-item">
                        <a class="nav-link" href="index.html">Etusivu (Tehtävä 1 Osa I)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="toteutus.html">Toteutus (Tehtävä 1 Osa II)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="pokemon.html">Poke haku (Tehtävä 2 Osa I & II)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="saa.html">Sää (Tehtävä 3)</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </div>
    </nav>

    <main>
        <!-- Otsikko ja ohjeet-->
        <h1>Pokémon haku</h1>
        <p>
            <input type="text" id="pokemonName" placeholder="Pokémon: esim. Entei">
            <button onclick="poke ()">Hae</button><br>

            <div id="nimi">Kirjoita laatikkoon Pokémonin nimi! :3</div>
            <p id="kuva2"></p>
            <button id="kaannaBtn" onclick="kaanna()" style="display: none;">Käännä</button>
            <div id="ominaisuudet" class="mt-3"></div>

        </p>
        
        <br>
        <!--Lisätiedot-->
        <h3>Pokémonien nimiä</h3>
        <p>Jos Pokémonien nimet on päässeet unohtumaan, <br> tässä alla esimerkkejä:</p>
        <ul class="ul-custom"> 
            <li>Mewtwo</li>
            <li>Mew</li>
            <li>Entei</li>
            <li>Raikou</li>
            <li>Suicune</li>
            <li>Zapdos</li>
            <li>Articuno</li>
            <li>Moltres</li>
            <li>Lucario</li>
        </ul>
        <br>
        <p>Tämän listan muodostamiseen on hyödynetty ChatGPT:n GPT-5 miniä, joka on GPT-5-arkkitehtuuriin perustuva tekoälyavustaja.
Olen käyttänyt promtia "Give me a list of pokemon names in HTML format, including cool pokemons like mewtwo and entei"</p>

        <!--Pokemon kuva-->
        <p id="kuva2"></p>
        </p>
    </main>

    <div id="vastaus" class="container mt-5"></div> <!--Tulostetaan JSON-->

    <script>

    //Luetaan syötetyt tiedot
    function poke() {
    const pokeName = document.getElementById("pokemonName").value.toLowerCase();
    const name = document.getElementById("pokemonName").value;

    fetch(`https://pokeapi.co/api/v2/pokemon/${pokeName}`)
        .then(response => {
            if (!response.ok) throw new Error("Pokemon not found");
            return response.json();
        })
        //Pokemonin tiedot ja jos ei löydy
        .then(data => pokekuva(data, name))
        .catch(error => {
            document.getElementById("kuva2").innerHTML = "";
            document.getElementById("nimi").innerHTML = "<span style='color:red;'>Hups, Pokémonia ei löydy!</span>";
            document.getElementById("kaannaBtn").style.display = "none";
            document.getElementById("ominaisuudet").innerHTML = "";
        });
}

//Kääntämiseen
function pokekuva(obj, name) {
    let pokeurl = obj.sprites.front_default;
    document.getElementById("kuva2").innerHTML = "<img src='" + pokeurl + "'>";
    document.getElementById("nimi").innerHTML = "<b>" + name + "</b>";
    document.getElementById("kaannaBtn").style.display = "inline-block";
}

//Väärinpäin ja lisää
function kaanna() {
    const name = document.getElementById("nimi").innerText.toLowerCase();
    fetch(`https://pokeapi.co/api/v2/pokemon/${name}`)
        .then(response => response.json())
        .then(data => {
            let backUrl = data.sprites.back_default;
            document.getElementById("kuva2").innerHTML = "<img src='" + backUrl + "'>";
            // Näytetään lisäominaisuudet
            let tyypit = data.types.map(t => t.type.name).join(", ");
            let paino = data.weight;
            let korkeus = data.height;

            document.getElementById("ominaisuudet").innerHTML = `
                <h4>Ominaisuudet</h4>
                <ul style="list-style-type:none; padding-left: 0;">
                    <li><b>Tyyppi:</b> ${tyypit}</li>
                    <li><b>Paino:</b> ${paino}</li>
                    <li><b>Korkeus:</b> ${korkeus}</li>
                </ul>
            `;
        })
        //Errori
        .catch(error => {
            document.getElementById("kuva2").innerHTML = "<p style='color:red;'>Tietoa ei voida hakea!</p>";
            document.getElementById("kaannaBtn").style.display = "none";
            document.getElementById("ominaisuudet").innerHTML = "";
            document.getElementById("nimi").innerHTML = "";
        });
}
    </script>
</body>